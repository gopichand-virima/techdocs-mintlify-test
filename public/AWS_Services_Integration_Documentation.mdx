# AWS Services Integration Documentation

- [Overview](#AWSServicesIntegrationDocumentation-Ove)

- [What's New in v6.1](#AWSServicesIntegrationDocumentation-Wha)

  - [Previously Supported Services (19 Services)](#AWSServicesIntegrationDocumentation-Pre)

  - [New Services in v6.1 (5 Services)](#AWSServicesIntegrationDocumentation-New)

- [Detailed Service Documentation](#AWSServicesIntegrationDocumentation-Det)

  - [AWS App Runner](#AWSServicesIntegrationDocumentation-AWS)

  - [AWS ECS (Elastic Container Service)](#AWSServicesIntegrationDocumentation-AWS)

  - [AWS EKS (Elastic Kubernetes Service)](#AWSServicesIntegrationDocumentation-AWS)

  - [AWS Lambda](#AWSServicesIntegrationDocumentation-AWS)

  - [AWS Batch](#AWSServicesIntegrationDocumentation-AWS)

  - [Enhanced Relationship Processing](#AWSServicesIntegrationDocumentation-Enh)

  - [Relationship Types Used](#AWSServicesIntegrationDocumentation-Rel)

# Overview

Virima v6.1 significantly expands AWS cloud infrastructure discovery capabilities by adding 5 new containerized and serverless compute services to the existing foundation of 19 previously supported services. This update focuses on modern cloud-native workloads including container orchestration, serverless functions, and batch processing.

# **What's New in v6.1**

**Five New Services Added:**

- AWS App Runner - Fully managed containerized web application service

- AWS ECS - Elastic Container Service for containerized applications

- AWS EKS - Elastic Kubernetes Service for Kubernetes workloads

- AWS Lambda - Serverless function computing

- AWS Batch - Batch computing workload management

**Enhanced Relationship Mapping:**

- Complete container orchestration visibility (ECS ↔ EC2, EKS ↔ Node Groups)

- Serverless infrastructure dependencies (App Runner ↔ Security Groups)

- Cross-service relationships for comprehensive service mapping

**Complete Service Coverage Matrix**

## Previously Supported Services (19 Services)

These services were available in previous Virima versions with established discovery patterns:

| Service              |     | Coverage Tier | Key Properties                               | Primary Relationships      |
|----------------------|-----|---------------|----------------------------------------------|----------------------------|
| AWS EC2              |     | Full (~90%)   | CPU, Memory, Instance State, Security Groups | VPC, Security Group, EBS   |
| AWS EBS              |     | Full (~85%)   | Volume Size, Type, Encryption, Attachment    | EC2 Instances              |
| AWS VPC              |     | Full (~80%)   | CIDR Block, DNS Settings, Route Tables       | Subnets, Internet Gateway  |
| AWS Security Group   |     | Full (~85%)   | Inbound/Outbound Rules, VPC Association      | EC2, RDS, Load Balancers   |
| AWS S3               |     | Medium (~70%) | Bucket Configuration, Access Policies        | Cross-service dependencies |
| AWS Load Balancer    |     | Full (~80%)   | Target Groups, Listeners, Health Checks      | VPC, Security Groups       |
| AWS Auto Scaling     |     | Full (~85%)   | Capacity, Policies, Launch Templates         | EC2, Target Groups         |
| AWS RDS              |     | Full (~85%)   | Database Engine, Multi-AZ, Backup Config     | Security Groups, Subnets   |
| AWS DynamoDB         |     | Medium (~75%) | Tables, Indexes, Capacity Settings           | IAM Roles                  |
| AWS ECR              |     | Medium (~70%) | Repositories, Images, Scanning Config        | ECS/EKS Dependencies       |
| AWS NAT Gateway      |     | Medium (~70%) | Network Translation, VPC Association         | VPC, Subnets               |
| AWS Network ACL      |     | Full (~80%)   | Network Rules, Subnet Association            | VPC, Subnets               |
| AWS AMI              |     | Medium (~75%) | Image Metadata, Platform Details             | EC2 Instances              |
| AWS Snapshot         |     | Medium (~70%) | Volume Snapshots, Encryption                 | EBS Volumes                |
| AWS Route Table      |     | Full (~80%)   | Routing Rules, Subnet Association            | VPC, Subnets               |
| AWS Internet Gateway |     | Full (~85%)   | VPC Attachment, Route Association            | VPC, Route Tables          |
| AWS Subnet           |     | Full (~90%)   | CIDR, Availability Zone, Route Tables        | VPC, EC2, Network ACL      |
| Target Group         |     | Full (~85%)   | Health Check Config, Target Registration     | Load Balancers, EC2        |
| Route                |     | Medium (~70%) | Destination, Gateway Association             | Route Tables, Gateways     |

## New Services in v6.1 (5 Services)

These services are newly implemented with modern cloud-native focus:

| Service        | Coverage Tier      | Key Properties                           | Primary Relationships                   |
|----------------|--------------------|------------------------------------------|-----------------------------------------|
| AWS App Runner | Full (~85%)        | Service URL, CPU/Memory, VPC Connection  | VPC Connector, Security Groups, ECR     |
| AWS ECS        | Full (~90%)        | Clusters, Services, Tasks, Launch Type   | EC2, VPC, Load Balancers, ECR           |
| AWS EKS        | Full (~85%)        | Clusters, Node Groups, Fargate Profiles  | VPC, Security Groups, EC2, Auto Scaling |
| AWS Lambda     | Medium-Full (~75%) | Function Config, Runtime, Memory/Timeout | IAM Roles, VPC, Log Groups              |
| AWS Batch      | Medium (~65%)      | Compute Environments, Job Queues         | ECS/EKS Clusters, VPC, Security Groups  |

# **Detailed Service Documentation**

## AWS App Runner

### Overview

AWS App Runner is a fully managed service for containerized web applications. New in Virima v6.1, this integration discovers App Runner services across all regions and maps their networking and container configurations.

### Supported Properties (Imported)

| Property              | Description                  | Example                                                          |
|-----------------------|------------------------------|------------------------------------------------------------------|
| Service ARN           | Unique service identifier    | arn:aws:apprunner:us-east-1:123456789012:service/my-app/abcd1234 |
| Service Name          | User-defined service name    | my-web-app                                                       |
| Service URL           | Public application endpoint  | https://abcd1234.us-east-1.awsapprunner.com                      |
| Status                | Operational state            | RUNNING, PAUSED                                                  |
| CPU Count             | Allocated vCPU units         | 1 vCPU, 2 vCPU                                                   |
| Memory (GB)           | Allocated memory             | 2, 4, 8                                                          |
| Auto Deployments      | Automatic deployment enabled | true, false                                                      |
| Container Port        | Application listening port   | 8080, 3000                                                       |
| Health Check Config   | Health monitoring settings   | Protocol, path, intervals                                        |
| VPC Connected         | VPC connectivity status      | true, false                                                      |
| Subnet IDs            | Associated subnets           | subnet-12345678,subnet-87654321                                  |
| Security Group IDs    | Associated security groups   | sg-12345678,sg-87654321                                          |
| Auto Scaling Config   | Scaling configuration        | Configuration name/ARN                                           |
| Publicly Accessible   | Public internet access       | true, false                                                      |
| IP Address Type       | Network addressing           | IPV4, DUAL_STACK                                                 |
| Observability Enabled | Monitoring features          | true, false                                                      |
| Image Repository Type | Container source             | ECR, ECR_PUBLIC                                                  |
| ECR Access Role ARN   | IAM role for ECR             | arn:aws:iam::123456789012:role/...                               |
| Image ID              | Container image identifier   | 123456789012.dkr.ecr.us-east-1.amazonaws.com/my-app:latest       |

### Unsupported Properties (Not Imported)

- Runtime environment variables (security)

- Custom domain mappings

- SSL certificate configurations

- Deployment history

- Real-time performance metrics

- Cost/billing information

### **Prerequisites**

IAM Permissions Required

{

"Version": "2012-10-17",

"Statement": \[

{

"Effect": "Allow",

"Action": \[

"apprunner : ListServices",

"apprunner : DescribeService",

"apprunner : DescribeVpcConnector",

"ec2 : DescribeRegions"

\],

"Resource": "\*"

}

\]

}

### **Network Requirements**

- Internet access for AWS SDK calls

- HTTPS (443) outbound to apprunner.{region}. amazonaws.com

- DNS resolution for AWS service endpoints

### **AWS Configuration Requirements**

- At least one App Runner service deployed

- VPC Connector configured (for VPC-connected services)

- ECR repository access (for private images)

### **How to Trigger an Import**

**Phase 1: Configure AWS Credentials (One-time setup)**

- **Navigate to Credentials Management**

  - Log into Virima platform

  - Click on Admin in the left navigation panel

  - Click on Credentials module

  - Click Add New Credential

- **Configure AWS Account Credentials**

  - Select credential type: AWS Account

  - Enter the following details:

    - AWS Access Key ID: Your AWS access key

    - AWS Secret Access Key: Your AWS secret key

    - AWS Account ID: Your 12-digit AWS account number

- **Click Save to store the credential**

**Phase 2: Create and Run Import Job**

- **Navigate to AWS Import**

  - Click on Discovery in the left navigation panel

  - Click on Import from AWS

- **Create Import Job**

  - Click Add AWS Import

  - Select the previously configured AWS credential from dropdown

  - **Choose Import Items**: Check the services you want to import:

    - ☑️ AWS App Runner

    - ☑️ AWS ECS

    - ☑️ AWS EKS

    - ☑️ AWS Lambda

    - ☑️ AWS Batch

    - ☑️ Other AWS services as needed

  - Enter **Import Name** and **Description**

  - Click Start Import

### **Mapping into CMDB/BSM**

Service Representation

- Blueprint: AWS AppRunner

- Primary Key: Service ARN

- Asset Name: Service name

- Location: AWS Region

Relationship Mapping

AWS AppRunner Service

├── SECURED_BY → AWS Security Group (VPC-connected)

├── CONNECTED_TO → AWS Subnet (VPC-connected)

├── SERVED_BY → VPC Connector (VPC-connected)

### **Scheduling & Frequency**

Recommended Frequency

- Production: Every 4-6 hours (deployment-driven changes)

- Development: Daily

- Staging: Every 2-3 hours

### **Troubleshooting & Error Handling**

Common Issues

| **Issue**           | **Cause**                     | **Solution**                                |
|---------------------|-------------------------------|---------------------------------------------|
| Permission Denied   | Insufficient IAM permissions  | Verify IAM policy includes required actions |
| Service Not Found   | App Runner service terminated | Check AWS console for service status        |
| VPC Connector Error | VPC connector misconfigured   | Verify VPC connector in AWSconsole          |

### **Best Practices & Limitations**

Integration Recommendations

- Combine with ECS/ECR imports for container registry visibility

- Use with VPC/Security Group imports for network mapping

- Supplement with CloudWatch for operational monitoring

## AWS ECS (Elastic Container Service)

### Overview

AWS ECS provides managed container orchestration. New in v6.1, this integration discovers ECS clusters, services, tasks, and task definitions across EC2 and Fargate launch types.

### Supported Properties (Imported)

#### **ECS Clusters**

| Property              | Description               | Example                                               |
|-----------------------|---------------------------|-------------------------------------------------------|
| Cluster ARN           | Unique cluster identifier | arn:aws:ecs:us-east-1:123456789012:cluster/my-cluster |
| Cluster Name          | User-defined name         | production-cluster                                    |
| Status                | Operational state         | ACTIVE, INACTIVE                                      |
| Running Tasks Count   | Currently running tasks   | 15                                                    |
| Pending Tasks Count   | Tasks starting up         | 2                                                     |
| Active Services Count | Services in cluster       | 8                                                     |
| Container Instances   | EC2 instances registered  | 5                                                     |
| Capacity Provider     | Default capacity strategy | FARGATE, EC2                                          |

#### **ECS Services**

| Property                  | Description                | Example                                               |
|---------------------------|----------------------------|-------------------------------------------------------|
| Service ARN               | Unique service identifier  | arn:aws:ecs:us-east-1:123456789012:service/my-service |
| Service Name              | User-defined name          | web-service                                           |
| Launch Type               | Task launch method         | FARGATE, EC2                                          |
| Platform Version          | Fargate platform version   | 1.4.0, LATEST                                         |
| Desired Count             | Target task count          | 3                                                     |
| Running Count             | Currently running          | 3                                                     |
| Task Definition           | Associated task definition | web-app:5                                             |
| Load Balancer Integration | Target group associations  | ALB/NLB target groups                                 |
| Service Discovery         | DNS service discovery      | namespace.service.local                               |

#### **ECS Tasks and ECS Fargate**

| Property               | Description                    | Example                                     |
|------------------------|--------------------------------|---------------------------------------------|
| Task ARN               | Unique task identifier         | arn:aws:ecs:us-east-1:123456789012:task/... |
| Task Definition ARN    | Associated definition          | Task definition reference                   |
| Container Instance ARN | Host EC2 instance (EC2 launch) | Container instance reference                |
| Cluster ARN            | Parent cluster                 | Cluster reference                           |
| Status                 | Current task status            | RUNNING, STOPPED, PENDING                   |
| CPU Units              | Allocated CPU                  | 512, 1024                                   |
| Memory (MB)            | Allocated memory               | 1024, 2048                                  |
| Network Mode           | Networking configuration       | awsvpc, bridge, host                        |
| IP Addresses           | Public/private IPs             | Network interface IPs                       |

### Prerequisites

IAM Permissions Required

{

"Version": "2012-10-17",

"Statement": \[

{

"Effect": "Allow",

"Action": \[

"ecs:ListClusters",

"ecs:DescribeClusters",

"ecs:ListServices",

"ecs:DescribeServices",

"ecs:ListTasks",

"ecs:DescribeTasks",

"ecs:ListTaskDefinitions",

"ecs:DescribeTaskDefinition",

"ec2:DescribeRegions"

\],

"Resource": "\*"

}

\]

}

### **Mapping into CMDB/BSM**

Service Representation

- ECS Clusters: Blueprint AWS ECS

- ECS Services: Blueprint AWS ECS Service

- EC2 Tasks: Blueprint AWS ECS Task

- Fargate Tasks: Blueprint AWS FARGATE

### **Relationship Mapping**

AWS ECS Cluster

├── CONTAINS → AWS ECS Service

│ ├── CONTAINS → AWS ECS Task / AWS FARGATE

│ └── SERVED_BY → AWS Load Balancer

├── CONTAINS → AWS EC2 Instance (EC2 launch type)

├── SECURED_BY → AWS Security Group

└── CONTAINS → AWS Subnet

### **Scheduling & Frequency**

- Production: Every 2-4 hours (containers are dynamic)

- Development: Every 6-8 hours

- Staging: Every 3-4 hours

## AWS EKS (Elastic Kubernetes Service)

### Overview

AWS EKS provides managed Kubernetes clusters. New in v6.1, this integration discovers EKS clusters, node groups, and Fargate profiles with comprehensive Kubernetes infrastructure mapping.

### Supported Properties (Imported)

#### **EKS Clusters**

| Property              | Description               | Example                                               |
|-----------------------|---------------------------|-------------------------------------------------------|
| Cluster ARN           | Unique cluster identifier | arn:aws:eks:us-east-1:123456789012:cluster/my-cluster |
| Cluster Name          | User-defined name         | production-k8s                                        |
| Version               | Kubernetes version        | 1.21, 1.22                                            |
| Status                | Cluster operational state | ACTIVE, CREATING                                      |
| Endpoint URL          | Kubernetes API endpoint   | https://ABC123.gr7.us-east-1.eks.amazonaws.com        |
| VPC Configuration     | Network settings          | VPC ID, subnets, security groups                      |
| OIDC Issuer URL       | Identity provider         | OIDC endpoint                                         |
| Logging Configuration | Enabled log types         | API, audit, authenticator logs                        |

#### **EKS Node Groups**

| Property              | Description              | Example                                          |
|-----------------------|--------------------------|--------------------------------------------------|
| Node Group ARN        | Unique identifier        | arn:aws:eks:us-east-1:123456789012:nodegroup/... |
| Instance Types        | EC2 instance types       | t3.medium,t3.large                               |
| Capacity Type         | Purchasing option        | ON_DEMAND, SPOT                                  |
| AMI Type              | Machine image type       | AL2_x86_64, AL2_ARM_64                           |
| Scaling Configuration | Min/max/desired capacity | Auto Scaling settings                            |
| Remote Access         | SSH configuration        | Key pair, security groups                        |

#### **EKS Fargate Profiles**

| Property           | Description       | Example                                               |
|--------------------|-------------------|-------------------------------------------------------|
| Profile ARN        | Unique identifier | arn:aws:eks:us-east-1:123456789012:fargateprofile/... |
| Pod Execution Role | IAM role for pods | Pod execution permissions                             |
| Subnets            | Fargate subnets   | Private subnet configuration                          |
| Selectors          | Pod selectors     | Namespace and label selectors                         |

### **Mapping into CMDB/BSM**

#### **Service Representation**

- EKS Clusters: Blueprint AWS EKS

- Node Groups: Blueprint AWS EKS Node Group

- Fargate Profiles: Blueprint AWS FARGATE

#### **Relationship Mapping**

AWS EKS Cluster

├── CONTAINS → AWS EKS Node Group

│ └── BELONGS_TO → AWS EC2 Instance (worker nodes)

├── CONTAINS → AWS FARGATE (Fargate profiles)

├── SECURED_BY → AWS Security Group

├── CONTAINS → AWS Subnet

└── SERVED_BY → VPC

## AWS Lambda

### Overview

AWS Lambda provides serverless function execution. New in v6.1, this integration discovers Lambda functions, configurations, and network settings with version management.

### Supported Properties (Imported)

| Property          | Description                | Example                                                    |
|-------------------|----------------------------|------------------------------------------------------------|
| Function ARN      | Unique function identifier | arn:aws:lambda:us-east-1:123456789012:function:my-function |
| Function Name     | User-defined name          | process-orders                                             |
| Runtime           | Programming runtime        | python3.9, nodejs16.x                                      |
| Role ARN          | Execution role             | IAM role for function execution                            |
| Architecture      | Processor architecture     | x86_64, arm64                                              |
| Memory Usage      | Allocated memory           | 512 MB, 1024 MB                                            |
| Timeout           | Maximum execution time     | 30, 900 seconds                                            |
| Ephemeral Storage | Temporary storage          | /tmp directory size                                        |
| Version           | Function version           | \$LATEST, numbered versions                                |
| State             | Function state             | Active, Inactive                                           |
| Log Group         | CloudWatch log group       | /aws/lambda/function-name                                  |
| Tracing Mode      | X-Ray tracing              | Active, PassThrough                                        |
| SnapStart Status  | Performance optimization   | Java runtime optimization                                  |

### **Mapping into CMDB/BSM**

#### **Relationship Mapping**

AWS Lambda Function

├── DEPENDS_ON → AWS IAM Role (execution role)

├── USES → AWS VPC (VPC-configured functions)

├── SECURED_BY → AWS Security Group (VPC functions)

├── CONTAINS → AWS Subnet (VPC functions)

└── LOGS_TO → CloudWatch Log Group

## AWS Batch

### Overview

AWS Batch enables batch computing workloads. New in v6.1, this integration discovers Batch compute environments and job queue configurations.

### Supported Properties (Imported)

| Property               | Description                    | Example                                                      |
|------------------------|--------------------------------|--------------------------------------------------------------|
| Batch ARN              | Compute environment identifier | arn:aws:batch:us-east-1:123456789012:compute-environment/... |
| Environment Name       | User-defined name              | production-batch-env                                         |
| Type                   | Environment type               | MANAGED, UNMANAGED                                           |
| Processor Type         | Compute resource type          | EC2, FARGATE                                                 |
| Instance Types         | EC2 instance types             | m5.large,c5.xlarge,optimal                                   |
| Capacity Configuration | Min/max/desired vCPUs          | Scaling parameters                                           |
| Network Configuration  | Subnets, security groups       | VPC networking                                               |
| Orchestration          | Container orchestration        | ECS, EKS                                                     |

### **Mapping into CMDB/BSM**

#### **Relationship Mapping**

AWS Batch Environment

├── SERVED_BY → AWS ECS/EKS Cluster

├── CONTAINS → AWS Subnet

├── SECURED_BY → AWS Security Group

└── USES → AWS EC2 Instance (EC2 compute type)

## Enhanced Relationship Processing

**New Relationship Threads in v6.1**

Based on the AWSInstancesProcessingThread implementation, v6.1 adds these relationship processing threads:

**EKS Relationships Thread (Thread 4)**

// EKS Cluster ↔ VPC/Security Group relationships

// EKS Cluster ↔ Node Group relationships

// EKS Node Group ↔ EC2 Instance relationships

// Subnet ↔ EKS Node Group relationships

**ECS Relationships Thread (Thread 5)**

// ECS Cluster ↔ ECS Services relationships

// ECS Cluster ↔ ECS Tasks relationships

**Fargate Relationships Thread (Thread 6)**

// Fargate ↔ ECS/EKS Cluster relationships

// Fargate ↔ Subnet relationships (networking)

**Batch Relationships Thread (Thread 7)**

// Batch ↔ ECS/EKS Cluster relationships

// Batch ↔ VPC/Subnet relationships

// Batch ↔ Security Group relationships

**App Runner Relationships Thread (Thread 8)**

// App Runner ↔ Security Group relationships

// App Runner ↔ Subnet relationships (VPC connector)

## Relationship Types Used

| Relationship | Usage                           | Example                            |
|--------------|---------------------------------|------------------------------------|
| CONTAINS     | Parent contains child resources | EKS Cluster CONTAINS Node Group    |
| SECURED_BY   | Security relationship           | Service SECURED_BY Security Group  |
| SERVED_BY    | Service dependency              | Batch SERVED_BY ECS Cluster        |
| BELONGS_TO   | Resource ownership              | Node Group BELONGS_TO EC2 Instance |

### **Global Prerequisites & Configuration**

Consolidated IAM Policy for All New Services

{

"Version": "2012-10-17",

"Statement": \[

{

"Effect": "Allow",

"Action": \[

"apprunner:ListServices",

"apprunner:DescribeService",

"apprunner:DescribeVpcConnector",

"ecs:ListClusters",

"ecs:DescribeClusters",

"ecs:ListServices",

"ecs:DescribeServices",

"ecs:ListTasks",

"ecs:DescribeTasks",

"eks:ListClusters",

"eks:DescribeCluster",

"eks:ListNodegroups",

"eks:DescribeNodegroup",

"eks:ListFargateProfiles",

"eks:DescribeFargateProfile",

"lambda:ListFunctions",

"lambda:GetFunction",

"lambda:ListVersionsByFunction",

"batch:DescribeComputeEnvironments",

"batch:ListComputeEnvironments",

"ec2:DescribeRegions"

\],

"Resource": "\*"

}

\]

}

### **Import Scheduling Best Practices**

**Service-Specific Frequencies**

| Service    | Production | Development | Reasoning                             |
|------------|------------|-------------|---------------------------------------|
| App Runner | 4-6 hours  | Daily       | Deployment-driven changes             |
| ECS        | 2-4 hours  | 6-8 hours   | Highly dynamic container tasks        |
| EKS        | 4-6 hours  | Daily       | Kubernetes clusters relatively stable |
| Lambda     | 6-8 hours  | Daily       | Function configs change infrequently  |
| Batch      | 8-12 hours | Daily       | Compute environments are static       |

**Orchestration Strategy**

- Staggered Imports: Different services at different times

- Dependency Order: Import clusters before services/tasks

- Error Isolation: Service failures don't affect other imports

### **Coverage Analysis & Value Proposition**

**v6.1 Service Coverage Tiers**

| Service    | Coverage Tier      |     | Properties Captured | CMDB/BSM Value                            |
|------------|--------------------|-----|---------------------|-------------------------------------------|
| App Runner | Full (~85%)        |     | 19 properties       | Complete containerized web app visibility |
| ECS        | Full (~90%)        |     | 20+ properties      | Comprehensive container orchestration     |
| EKS        | Full (~85%)        |     | 21+ properties      | Complete Kubernetes infrastructure        |
| Lambda     | Medium-Full (~75%) |     | 18 properties       | Serverless function configuration         |
| Batch      | Medium (~65%)      |     | 15 properties       | Batch processing infrastructure           |

### **Business Value by Tier**

**Medium Tier Benefits (Lambda, Batch)**

- Service inventory and capacity planning

- Basic dependency mapping

- Compliance reporting foundation

**Full Tier Benefits (App Runner, ECS, EKS)**

- Complete container orchestration visibility

- Advanced impact analysis capabilities

- Comprehensive security posture assessment

- Business service mapping integration

- Change management automation
